 ### Общее описание задачи
Требуется написать DAG, который будет считать определенные метрики по ленте новостей (feed_actions) и ленте сообщений (message_actions) каждый день за вчера. 
Каждая выгрузка должна быть в отдельном таске. 
Данные автоматически должны подгружаться в отдельную таблицу в Clickhouse.

### Описание данных
Данные ленты новостей (feed_actions):
 - *user_id* - идентификатор пользователя
 - *post_id* - идентификатор поста ленты новостей
 - *action* - действие пользователя (view - просмотр, like - лайк)
 - *time* - дата и время взаимодействия с постом ленты новостей
 - *gender* - пол (1 - женщина, 0 - мужчина)
 - *age* - возраст
 - *country* - страна
 - *city* - город
 - *os* - операционная система (Android или iOS)
 - *source* - источник трафика (organic - обычная поисковая выдача, ads - рекламное объявление)
 - *exp_group* - группа для эксперимента (0, 1, 2, 3 или 4)

Данные ленты сообщений (message_actions):
 - *user_id* - идентификатор пользователя
 - *reciever_id* - индентификатор пользователя, который получил сообщение
 - *time* - дата и время отправки сообщения
 - *gender* - пол (1 - женщина, 0 - мужчина)
 - *age* - возраст
 - *country* - страна
 - *city* - город
 - *os* - операционная система (Android или iOS)
 - *source* - источник трафика (organic - обычная поисковая выдача, ads - рекламное объявление)
 - *exp_group* - группа для эксперимента (0, 1, 2, 3 или 4)


### Этапы реализации задачи
**1.Подсчет метрик**:

**1.1.** Из таблица *feed_actions* для каждого пользователя посчитать (**task - total_lv**):

- количество просмотров (views)
- количество лайков (likes).

**1.2.** Из таблицы *message_actions* для каждого пользователя посчитать (**task - total_m**):  
    
- количество отправленных сообщений (messages_sent)
- количество полученных сообщений (messages_received)
- количество пользователей, которым отправлены сообщения (users_sent)
- количество пользователей, от которых получены сообщения (users_received).

**2.** Объедение таблиц в одну (**task – df_merging**).
   
**3.** Подсчет всеx метрик в разрезе по:
        
- полу (**task – to_gender**)
- возрасту (**task – to_age**)
- операционной системе (**task – to_os**).
   
**4.** Загрузка данных (**task – load**) в финальную таблицу со следующей структурой:
   - Дата - event_date
   - Название среза – dimension
   - Значение среза - dimension_value
   - Количество просмотров - views
   - Количество лайков - likes
   - Количество отправленных сообщений (messages_sent)
   - Количество полученных сообщений (messages_received)
   - Количество пользователей, которым отправлены сообщения (users_sent)
   - Количество пользователей, от которых получены сообщения (users_received).
